/*
SASEUL JS
https://github.com/saseul/saseul-js
(c) 2016-2022 by ArtiFriends Inc. All rights reserved.
*/
var SASEUL=SASEUL||function(){var r={};r.Core={hash:function(r,t){return CryptoJS[r](t).toString(CryptoJS.enc.Hex)},time:function(){return parseInt((new Date).getTime()/1e3)},utime:function(){return parseInt((new Date).getTime()+"000")},randomHexString:function(r){for(var t="",n=0;n<2*r;n++){t+=Math.floor(16*Math.random()).toString(16)}return t},hexToByte:function(r){if(!r)return new Uint8Array;for(var t=[],n=0,e=r.length;n<e;n+=2)t.push(parseInt(r.substr(n,2),16));return new Uint8Array(t)},byteToHex:function(r){if(!r)return"";for(var t="",n=0;n<r.length;n++){var e=(255&r[n]).toString(16);t+=e=1===e.length?"0"+e:e}return t.toLowerCase()},stringToByte:function(r){for(var t=new Uint8Array(new ArrayBuffer(r.length)),n=0,e=r.length;n<e;n++)t[n]=r.charCodeAt(n);return t},stringToUnicode:function(r){if(!r)return"";let t="";for(let n=0;n<r.length;n++){let e=r[n].charCodeAt(0).toString(16);e.length>2?t+="\\u"+e:t+=r[n]}return t}};return r}();!function(){var t=SASEUL,n=t.Core;t.Enc={SHORT_HASH_SIZE:40,ID_HASH_SIZE:44,HASH_SIZE:64,HEX_TIME_SIZE:14,TIME_HASH_SIZE:78,string:function(t){return"string"!=typeof t&&(t=JSON.stringify(t)),n.stringToUnicode(t.replaceAll("/","\\/"))},hash:function(t){return n.hash("SHA256",this.string(t))},shortHash:function(t){return n.hash("RIPEMD160",this.hash(t))},checksum:function(t){return n.hash("SHA256",n.hash("SHA256",t)).substr(0,4)},hextime:function(t){return"number"!=typeof t&&(t=n.utime()),(t=t.toString(16)).length>this.HEX_TIME_SIZE?t.substr(0,this.HEX_TIME_SIZE):t.toString(16).padStart(this.HEX_TIME_SIZE,"0")},timeHash:function(t,n){return this.hextime(n)+this.hash(t)},timeHashValidity:function(t){return!0===this.isHex(t)&&t.length===this.TIME_HASH_SIZE},idHash:function(t){var n=this.shortHash(t);return n+this.checksum(n)},idHashValidity:function(t){return!0===this.isHex(t)&&t.length===this.ID_HASH_SIZE&&this.checksum(t.substr(0,this.SHORT_HASH_SIZE))===t.substr(-4)},spaceId:function(t,n){return this.hash([t,n])},txHash:function(t){return this.timeHash(this.hash(t),t.timestamp)},isHex:function(t){return"string"==typeof t&&Boolean(t.match(/^[0-9a-f]+$/))},parseCode:function(t){return"string"==typeof t&&(t=JSON.parse(t)),void 0===t.w?{cid:SASEUL.Enc.spaceId(t.writer,t.nonce),name:t.name??"",writer:t.writer??"",type:t.type??"",version:t.version??"0",parameters:t.parameters??{},nonce:t.nonce??""}:{cid:SASEUL.Enc.spaceId(t.w,t.s),name:t.n??"",writer:t.w??"",type:t.t??"",version:t.v??"0",parameters:t.p??{},nonce:t.s??""}}}}();!function(){var e=SASEUL,i=e.Core,t=e.Enc;e.Sign={KEY_SIZE:64,SIGNATURE_SIZE:128,keyPair:function(){var e=nacl.sign.keyPair(),t={};return t.private_key=i.byteToHex(e.secretKey).substring(0,64),t.public_key=i.byteToHex(e.publicKey),t.address=this.address(t.public_key),t},privateKey:function(){return i.byteToHex(nacl.sign.keyPair().secretKey).substring(0,64)},publicKey:function(e){return i.byteToHex(nacl.sign.keyPair.fromSeed(i.hexToByte(e)).publicKey)},address:function(e){return t.idHash(e)},addressValidity:function(e){return t.idHashValidity(e)},signature:function(e,n){return i.byteToHex(nacl.sign.detached(i.stringToByte(t.string(e)),i.hexToByte(n+this.publicKey(n))))},signatureValidity:function(e,n,r){return r.length===this.SIGNATURE_SIZE&&!0===t.isHex(r)&&nacl.sign.detached.verify(i.stringToByte(e),i.hexToByte(r),i.hexToByte(n))},keyValidity:function(e){return e.length===this.KEY_SIZE&&t.isHex(e)}}}();!function(){var t=SASEUL,e=t.Core,n=t.Enc,r=t.Sign,o=t.Rpc={default_peers:["main.saseul.net","aroma.saseul.net","blanc.saseul.net"],ping:function(t){return"object"!=typeof t&&(t=this.default_peers),new Promise((function(e){o._searchPeers(t,(function(t){o._queryRounds(t,(function(t){e(t)}))}))}))},searchPeers:function(t){return"object"!=typeof t&&(t=this.default_peers),new Promise((function(e){o._searchPeers(t,(function(t){e(t)}))}))},_searchPeers:function(t,e){o.multi(t,"/peer",{method:"POST",mode:"cors"},(function(t){var n=[];t.forEach((function(t){try{Object.values(t.data.peers).forEach((function(t){n.push(t.host)}))}catch(t){}})),e([...new Set(n)])}))},queryRounds:function(t){return"object"!=typeof t&&(t=this.default_peers),new Promise((function(e){o._queryRounds(t,(function(t){e(t)}))}))},_queryRounds:function(t,e){o.multi(t,"/round?chain_type=all",{method:"POST",mode:"cors"},(function(t){var n=[];t.forEach((function(t){try{n.push({host:t.host,main:t.data.main.block,resource:t.data.resource.block})}catch(t){}})),e(n)}))},transaction:function(t,e){return"string"!=typeof e&&(e=r.privateKey()),this.data(t,e)},request:function(t,e){return"string"!=typeof e&&(e=r.privateKey()),this.data(t,e,"request")},data:function(t,o,s="transaction"){var u={};try{return t.from=r.address(r.publicKey(o)),"number"!=typeof t.timestamp&&(t.timestamp=e.utime()),u[s]=t,u.public_key=r.publicKey(o),u.signature=r.signature(n.txHash(t),o),u}catch(t){return r.keyValidity(o)?(console.error(t),{}):(console.error("Invalid private key: "+o),{})}},send:function(t,e){var r,s=new FormData;return"string"!=typeof e?(console.error("The host URL is required. "),new Promise((function(t){t({code:999,msg:"The host URL is required. "})}))):("object"==typeof t.transaction?(s.append("transaction",n.string(t.transaction)),r=e+"/sendtransaction"):(s.append("request",n.string(t.request)),r=e+"/request"),s.append("public_key",t.public_key),s.append("signature",t.signature),new Promise((function(t){o._send(s,r,(function(e){t(e)}))})))},_send:function(t,e,n){fetch(o.wrapUrl(e),{method:"POST",mode:"cors",body:t}).then((function(t){return t.json()}),(function(t){return{code:999,msg:t.message}})).then((function(t){n(t)}))},multi:function(t,e,n,r,s=9){var u=[],i=0,a=Math.min(t.length,s);(t=this.shuffle(t)).forEach((function(t,s){s<a&&fetch(o.wrapUrl(t+e),n).then((function(t){return t.json()}),(function(t){return{code:999,msg:t.message}})).then((function(e){try{u.push({host:t,data:e.data})}catch(t){}if(i++==a-1)try{r(u)}catch(t){}}))}))},shuffle:function(t){return t.map((t=>({v:t,i:Math.random()}))).sort(((t,e)=>t.i-e.i)).map((({v:t})=>t))},wrapUrl:function(t){return"http://"===t.substring(0,7)||"https://"===t.substring(0,8)||"//"===t.substring(0,2)?t:"//"+t}}}();